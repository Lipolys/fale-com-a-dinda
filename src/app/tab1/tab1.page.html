<ion-header [translucent]="true" class="header-dinda">
  <ion-toolbar class="header-toolbar">
    <ion-title>
      <div class="header-content">
        <span class="greeting">Ol√°! üëã</span>
        <span class="subtitle" *ngIf="tipoUsuario === 'CLIENTE'">Seus rem√©dios de hoje</span>
        <span class="subtitle" *ngIf="tipoUsuario === 'FARMACEUTICO'">Painel do Farmac√™utico</span>
      </div>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="main-content">

  <!-- VIEW DO CLIENTE -->
  <div *ngIf="tipoUsuario === 'CLIENTE'">
    <div class="empty-state" *ngIf="medicamentosHoje.length === 0">
      <h3>Tudo tranquilo por aqui!</h3>
      <p>Voc√™ n√£o tem medicamentos agendados para hoje.</p>
      <ion-button expand="block" class="action-btn" (click)="adicionarMedicamento()">
        Adicionar Medicamento
      </ion-button>
    </div>

    <div class="timeline-container" *ngIf="medicamentosHoje.length > 0">
      <!-- Alerta de Intera√ß√µes Medicamentosas - Din√¢mico -->
      <div class="alert-dinda alert-danger" style="margin-top: 20px;" *ngIf="interacoesUsuario.length > 0">
        <ion-icon name="warning"></ion-icon>
        <div>
          <strong>‚ö†Ô∏è Aten√ß√£o! Intera√ß√µes Medicamentosas Detectadas</strong><br><br>
          <div *ngFor="let interacao of interacoesUsuario" style="margin-bottom: 10px;">
            <strong style="color: #d32f2f;">{{ interacao.medicamento1_nome }} + {{ interacao.medicamento2_nome }}</strong><br>
            <span style="font-size: 14px;">{{ interacao.descricao }}</span>
            <span style="font-size: 12px; background: rgba(211, 47, 47, 0.1); padding: 2px 6px; border-radius: 4px; margin-left: 8px;">
              Gravidade: {{ interacao.gravidade }}
            </span>
          </div>
          <div style="margin-top: 12px; font-style: italic; font-size: 14px;">
            Consulte seu m√©dico ou farmac√™utico.
          </div>
        </div>
      </div>

      <div class="timeline-item" *ngFor="let item of medicamentosHoje" [class.completed]="item.status === 'tomado'">

        <div class="time-column">
          <span class="time">{{ item.horario }}</span>
          <div class="line"></div>
        </div>

        <div class="card-column">
          <ion-card class="med-card" [ngClass]="item.status">
            <div class="card-status-strip" [style.background]="'var(--ion-color-' + item.cor + ')'"></div>

            <ion-card-content>
              <div class="med-header">
                <div class="med-info">
                  <h2>{{ item.ministracao.medicamento_nome }}</h2>
                  <p class="dosage">
                    <ion-icon name="fitness-outline"></ion-icon>
                    {{ item.ministracao.dosagem }}
                  </p>
                </div>
                <ion-badge [color]="item.cor" class="status-badge">
                  {{ getStatusBadge(item.status) }}
                </ion-badge>
              </div>

              <div class="med-actions" *ngIf="item.status !== 'tomado'">
                <ion-button fill="clear" size="small" (click)="verDetalhes(item)">
                  Detalhes
                </ion-button>
                <ion-button class="take-btn" [color]="item.cor" expand="block" (click)="marcarComoTomado(item)">
                  <ion-icon [name]="item.icone" slot="start"></ion-icon>
                  Marcar como tomado
                </ion-button>
              </div>

              <div class="med-completed" *ngIf="item.status === 'tomado'">
                <ion-icon name="checkmark-done-circle" color="success"></ion-icon>
                <span>Tomado √†s {{ item.ministracao.ultimaTomada | date:'HH:mm' }}</span>
              </div>
            </ion-card-content>
          </ion-card>
        </div>
      </div>
    </div>
  </div>

  <!-- VIEW DO FARMACEUTICO -->
  <div *ngIf="tipoUsuario === 'FARMACEUTICO'" class="pharmacist-dashboard">
    <div class="dashboard-grid">

      <ion-card class="dashboard-card" (click)="gerenciarMedicamentos()">
        <ion-card-header>
          <div class="icon-container color-primary">
            <ion-icon name="medkit"></ion-icon>
          </div>
          <ion-card-title>Medicamentos</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          Gerenciar cat√°logo de medicamentos
        </ion-card-content>
      </ion-card>

      <ion-card class="dashboard-card" (click)="gerenciarFaqs()">
        <ion-card-header>
          <div class="icon-container color-secondary">
            <ion-icon name="help-buoy"></ion-icon>
          </div>
          <ion-card-title>FAQs</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          Gerenciar perguntas frequentes
        </ion-card-content>
      </ion-card>

      <ion-card class="dashboard-card" (click)="gerenciarDicas()">
        <ion-card-header>
          <div class="icon-container color-tertiary">
            <ion-icon name="bulb"></ion-icon>
          </div>
          <ion-card-title>Dicas de Sa√∫de</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          Criar e editar dicas para pacientes
        </ion-card-content>
      </ion-card>

      <ion-card class="dashboard-card" (click)="gerenciarInteracoes()">
        <ion-card-header>
          <div class="icon-container color-danger">
            <ion-icon name="git-network"></ion-icon>
          </div>
          <ion-card-title>Intera√ß√µes</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          Verificar e gerenciar intera√ß√µes
        </ion-card-content>
      </ion-card>

    </div>
  </div>

</ion-content>
